{"version":3,"sources":["main.ts"],"names":[],"mappings":"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","file":"../chonky_cabbage/scripts/main.js","sourcesContent":["import { world, system, BlockPermutation } from \"@minecraft/server\";\nimport RoadMaker, { WorkType } from \"./RoadMaker\";\nimport Debug from \"./Debug\";\n\nconst TicksPerSecond: number = 20;\nconst HeadHeightInBlocks:number = 2;\nconst SecondsBeforeInit:number = 20;\nconst SecondsBetweenRoadmakerTicks: number = 0.2;\n\nlet roadmaker:RoadMaker;\nlet initialized:boolean = false;\n\n// road maker initialization\nfunction initialize() {\n  Debug.trace(\"Initializing RoadMaker...\");\n  try{\n    roadmaker = new RoadMaker();\n  }\n  catch(e)\n  {\n    Debug.error(`Failed to start RoadMaker: ${e}`);\n  }\n  Debug.info(\"RoadMaker initialized:\");\n  help();\n  initialized = true;\n}\n\n// main game loop\nfunction mainTick() {\n  if(initialized === false && system.currentTick > (TicksPerSecond * SecondsBeforeInit)){\n    Debug.trace(\"Starting Add-On capabilities...\");\n    initialize();\n  }\n\n  if(initialized === true && system.currentTick % (SecondsBetweenRoadmakerTicks * TicksPerSecond) === 0)\n  {   \n    try {\n      roadmaker.tryTickIteration();\n    }\n    catch(e)\n    {\n      Debug.error(`Failed to complete road: ${e}`);\n      roadmaker.cancelRoad();\n    }\n    \n  }\n\n  system.run(mainTick);\n}\n\nfunction help() {\n  Debug.info(\"Help: /scriptevent rd:help\")\n  Debug.info(\"Make Road: /scriptevent rd:road 10\");\n  Debug.info(\"Make Stairs Up: /scriptevent rd:stairs_up 10\");\n  Debug.info(\"Make Stairs Down: /scriptevent rd:stairs_down 10\");\n  Debug.info(\"Cancel Road: /scriptevent rd:cancel\");\n  Debug.info(\"Style Road: /scriptevent rd:assign Path=birch_planks\");\n  Debug.info(\"Road Block Types:\")\n  Debug.info(\"- Foundation\");\n  Debug.info(\"- Wall\");\n  Debug.info(\"- Path\");\n  Debug.info(\"- Post\");\n  Debug.info(\"- Light\");\n  Debug.info(\"- Stair\");\n}\n\n\n\n// listen for script events\nsystem.afterEvents.scriptEventReceive.subscribe((event) => {\n\n  // assume player 1 for now\n  let plyr = world.getAllPlayers()[0];\n\n  // EARLY OUT: no player\n  if(plyr == null || roadmaker == null)\n  {\n    return;\n  }\n\n  const coord = plyr.getHeadLocation();\n  const view = plyr.getViewDirection();\n  coord.y -= HeadHeightInBlocks;\n\n  switch(event.id)\n  {\n    case \"rd:help\":\n      help();\n      break\n    case \"rd:cancel\":\n      roadmaker.cancelRoad();\n      break;\n    case \"rd:road\":\n      if(roadmaker.isRoadInProgress() === false) {\n        const length:number = parseInt(event.message);\n        roadmaker.startNewRoad(coord, view, length);\n      }\n      break;\n    case \"rd:stairs_up\":\n      if(roadmaker.isRoadInProgress() === false) {\n        const length:number = parseInt(event.message);\n        roadmaker.startNewRoad(coord, view, length, WorkType.StairsUp);\n      }\n      break;\n    case \"rd:stairs_down\":\n      if(roadmaker.isRoadInProgress() === false) {\n        const length:number = parseInt(event.message);\n        roadmaker.startNewRoad(coord, view, length, WorkType.StairsDown);\n      }\n      break;\n    case \"rd:assign\":\n      const arg = event.message;\n      let kvp = arg.split(\"=\");\n      if(kvp.length == 2)\n      {\n        let block = kvp[0];\n        let assign = kvp[1].replace(\"minecraft:\",\"\");\n        Debug.debug(`Setting ${block} to ${assign}.`);\n        roadmaker.tryAssignBlockType(block,assign);\n      }\n      else{\n        Debug.error(`Unexpected argument format: ${arg}`);\n      }\n    ;\n  }\n});\n\n// start application\nDebug.trace(\"Starting main tick listener\");\nsystem.run(mainTick);"],"sourceRoot":"../../../scripts/"}